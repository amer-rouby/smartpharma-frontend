<div class="sidebar" [class.collapsed]="isCollapsed()">

  <!-- Logo Section -->
  <div class="sidebar-logo" routerLink="/dashboard">
    <div class="logo-icon">
      <mat-icon>local_pharmacy</mat-icon>
    </div>
    @if (!isCollapsed()) {
    <span class="logo-text">صيدليتي الذكية</span>
    }
  </div>

  <!-- Menu Items -->
  <mat-nav-list class="sidebar-menu">
    @for (item of menuItems; track item.label; let i = $index) {

    <!-- Single Menu Item (No Children) -->
    @if (!item.children && hasAccess(item.roles)) {
    <a mat-list-item [routerLink]="item.route" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
      [matTooltip]="isCollapsed() ? item.label : ''" matTooltipPosition="right">
      <mat-icon matListItemIcon>{{item.icon}}</mat-icon>
      @if (!isCollapsed()) {
      <span matListItemTitle>{{item.label}}</span>
      }
    </a>
    }

    <!-- Expandable Menu Item (With Children) -->
    @if (item.children && hasAccess(item.roles)) {
    <mat-expansion-panel class="sidebar-expansion" hideToggle [expanded]="isExpanded(i)">
      <mat-expansion-panel-header (click)="togglePanel(i)">
        <mat-panel-title>
          <mat-icon matListItemIcon>{{item.icon}}</mat-icon>
          @if (!isCollapsed()) {
          <span>{{item.label}}</span>
          }
        </mat-panel-title>
      </mat-expansion-panel-header>

      <mat-nav-list class="submenu">
        @for (child of item.children; track child.label) {
        <a mat-list-item [routerLink]="child.route" routerLinkActive="active"
          [matTooltip]="isCollapsed() ? child.label : ''" matTooltipPosition="right">
          <mat-icon matListItemIcon>{{child.icon}}</mat-icon>
          @if (!isCollapsed()) {
          <span matListItemTitle>{{child.label}}</span>
          }
        </a>
        }
      </mat-nav-list>
    </mat-expansion-panel>
    }
    }
  </mat-nav-list>

  <!-- Footer -->
  @if (!isCollapsed()) {
  <div class="sidebar-footer">
    <div class="version-info">
      <mat-icon>info</mat-icon>
      <span>الإصدار 1.0.0</span>
    </div>
  </div>
  }
</div>
